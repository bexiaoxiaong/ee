import{g as e,s as t,a,b as i,c as l,d as s,w as c,n,i as o,o as d,e as r,f as u,t as g,h as m,j as f}from"./index-C7cQ2gV0.js";const h=((e,t)=>{const a=e.__vccOpts||e;for(const[i,l]of t)a[i]=l;return a})({onLoad(){this.generateQRCode("默认二维码内容")},data:()=>({logoUrl:"/static/logo.png",qrUrl:"",bgUrl:"",logoHeight:0,backgroundOptions:[{name:"蓝色星空",url:"/static/bg1.png"},{name:"城市夜景",url:"/static/bg2.png"},{name:"纯白背景",url:"/static/bg3.png"},{name:"没有背景",url:""},{name:"自定义背景",url:null}],ticketNumber:"4311314",ticketType:"成人票",ticketPrice:"¥88",ticketSeat:"A1",bookingNumber:"T20250721001",eventName:"2025 成都音乐节",userName:"张三",pageRef:null}),mounted(){this.pageRef=this.$refs.pageRef},methods:{onImageLoad(t){const{width:a,height:i}=t.detail,l=e().windowWidth,s=i/a;this.logoHeight=l*s},async onSaveTiket(){navigator.clipboard&&window.ClipboardItem?a({itemList:["复制","保存"],success:async e=>{if(!window.html2canvas)return i({title:"截图插件未加载",icon:"none"});const t=this.$refs.pageRef,a=await html2canvas(t,{useCORS:!0});if(1===e.tapIndex){const e=a.toDataURL("image/png");if(/iP(hone|od|ad)/.test(navigator.userAgent))window.open(e,"_blank"),i({title:"长按图片保存",icon:"none"});else{const t=document.createElement("a");t.href=e,t.download="ticket.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}0===e.tapIndex&&a.toBlob((async e=>{if(!navigator.clipboard||!window.ClipboardItem)return i({title:"不支持剪贴板",icon:"none"});try{await navigator.clipboard.write([new ClipboardItem({"image/png":e})]),i({title:"已复制图片",icon:"success"})}catch(t){i({title:"复制失败",icon:"none"})}}),"image/png")}}):t({title:"提示",content:"当前浏览器不支持复制图片到剪贴板，请手动保存",showCancel:!1})},onPageTap(e){this.selectBackground()},selectBackground(){const e=this.backgroundOptions.map((e=>e.name));a({itemList:e,success:e=>{const t=this.backgroundOptions[e.tapIndex];"自定义背景"===t.name?l({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{e.tempFilePaths.length>0&&(this.bgUrl=e.tempFilePaths[0])}}):this.bgUrl=t.url}})},generateQRCode(e){QRCode.toDataURL(e).then((e=>{this.qrUrl=e})).catch((e=>{console.error("生成二维码失败",e)}))},changeQRCode(){t({title:"输入二维码内容",editable:!0,success:e=>{if(e.confirm&&e.content){const t=e.content.trim();if(!/^https:\/\/[^\s]+$/.test(t))return void i({title:"请输入完整的 HTTPS 链接",icon:"none"});this.generateQRCode(t)}}})},changeImage(){l({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{e.tempFilePaths.length>0&&(this.logoUrl=e.tempFilePaths[0])}})},changeTicketNumber(){t({title:"修改票券細號",content:"当前："+this.ticketNumber,editable:!0,placeholderText:"请输入新编号",success:e=>{e.confirm&&e.content&&(this.ticketNumber=e.content)}})},editField(e){const a={ticketType:"票种",ticketPrice:"票价",ticketSeat:"票位",bookingNumber:"订票编号",eventName:"活动名称",userName:"姓名"};t({title:`修改${a[e]}`,editable:!0,placeholderText:`请输入${a[e]}`,success:t=>{t.confirm&&""!==t.content&&(this[e]=t.content)}})}}},[["render",function(e,t,a,i,l,h){const p=m,k=o,b=f;return d(),s(k,{class:"page",ref:"pageRef",style:n({backgroundImage:"url("+l.bgUrl+")"})},{default:c((()=>[r(k,{class:"section logo-section"},{default:c((()=>[r(p,{class:"logo",src:l.logoUrl,onClick:h.changeImage,style:n({height:l.logoHeight+"px"}),mode:"widthFix",onLoad:h.onImageLoad},null,8,["src","onClick","style","onLoad"])])),_:1}),r(k,{class:"section qr-section"},{default:c((()=>[r(p,{src:l.qrUrl,class:"qr",onClick:h.changeQRCode},null,8,["src","onClick"])])),_:1}),r(k,{class:"section ticket-section"},{default:c((()=>[r(b,{class:"ticket-text",onClick:h.changeTicketNumber},{default:c((()=>[u("票券細號："+g(l.ticketNumber),1)])),_:1},8,["onClick"]),r(k,{class:"ticket-info"},{default:c((()=>[r(k,{class:"info-item"},{default:c((()=>[r(b,{class:"info-label"},{default:c((()=>[u("票种")])),_:1}),r(b,{class:"info-value",onClick:t[0]||(t[0]=e=>h.editField("ticketType"))},{default:c((()=>[u(g(l.ticketType),1)])),_:1})])),_:1}),r(k,{class:"info-item with-divider"},{default:c((()=>[r(b,{class:"info-label"},{default:c((()=>[u("票价")])),_:1}),r(b,{class:"info-value",onClick:t[1]||(t[1]=e=>h.editField("ticketPrice"))},{default:c((()=>[u(g(l.ticketPrice),1)])),_:1})])),_:1}),r(k,{class:"info-item with-divider"},{default:c((()=>[r(b,{class:"info-label"},{default:c((()=>[u("票位")])),_:1}),r(b,{class:"info-value",onClick:t[2]||(t[2]=e=>h.editField("ticketSeat"))},{default:c((()=>[u(g(l.ticketSeat),1)])),_:1})])),_:1})])),_:1})])),_:1}),r(k,{class:"detail-section"},{default:c((()=>[r(k,{class:"detail-title",onClick:h.onSaveTiket},{default:c((()=>[u("详细资讯")])),_:1},8,["onClick"]),r(k,{class:"detail-row"},{default:c((()=>[r(b,{class:"detail-label"},{default:c((()=>[u("订票编号")])),_:1}),r(b,{class:"detail-value",onClick:t[3]||(t[3]=e=>h.editField("bookingNumber"))},{default:c((()=>[u(g(l.bookingNumber),1)])),_:1})])),_:1}),r(k,{class:"divider"}),r(k,{class:"detail-row"},{default:c((()=>[r(b,{class:"detail-label"},{default:c((()=>[u("活动名称")])),_:1}),r(b,{class:"detail-value",onClick:t[4]||(t[4]=e=>h.editField("eventName"))},{default:c((()=>[u(g(l.eventName),1)])),_:1})])),_:1}),r(k,{class:"divider"}),r(k,{class:"detail-row"},{default:c((()=>[r(b,{class:"detail-label"},{default:c((()=>[u("姓名")])),_:1}),r(b,{class:"detail-value",onClick:t[5]||(t[5]=e=>h.editField("userName"))},{default:c((()=>[u(g(l.userName),1)])),_:1})])),_:1})])),_:1}),r(k,{class:"footer-section",onClick:h.onPageTap},null,8,["onClick"])])),_:1},8,["style"])}],["__scopeId","data-v-166069c3"]]);export{h as default};
